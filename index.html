<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Host Analytics">
<title>Host Analytics ‚Äî Airbnb Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700;800&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
:root{--coral:#FF5A5F;--coral-light:#FF8A8D;--teal:#00A699;--gold:#FFB400;--purple:#914669;--bg:#FAFAF8;--card:#FFF;--text:#1A1A1A;--text-mid:#4A4A4A;--text-light:#8B8B8B;--border:#E8E8E4;--border-light:#F0F0EC;--font:'DM Sans',-apple-system,sans-serif;--display:'Playfair Display',Georgia,serif}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:var(--font);background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
.header{background:var(--card);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100}
.header-inner{max-width:1240px;margin:0 auto;padding:0 24px;height:60px;display:flex;align-items:center;justify-content:space-between}
.logo{display:flex;align-items:center;gap:10px}
.logo-icon{width:34px;height:34px;border-radius:9px;background:linear-gradient(135deg,var(--coral),var(--coral-light));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:16px;font-family:var(--display)}
.logo-text{font-family:var(--display);font-size:19px;font-weight:700}
.tabs{display:flex;gap:2px}
.tab-btn{padding:7px 16px;border-radius:7px;border:none;cursor:pointer;font-family:var(--font);font-size:13px;font-weight:600;background:transparent;color:var(--text-light);transition:all .2s}
.tab-btn.active{background:var(--coral);color:#fff}
.tab-btn:hover:not(.active){background:var(--border-light)}
.year-filter{display:flex;gap:4px;align-items:center;flex-wrap:wrap}
.year-label{font-size:12px;color:var(--text-light);margin-right:6px}
.year-btn{padding:5px 10px;border-radius:6px;cursor:pointer;border:1px solid var(--border);background:transparent;color:var(--text-light);font-size:12px;font-weight:600;font-family:var(--font);transition:all .15s}
.year-btn.active{border-color:var(--coral);background:rgba(255,90,95,.06);color:var(--coral)}
.gran-btn{padding:5px 10px;border-radius:6px;cursor:pointer;border:1px solid var(--border);background:transparent;color:var(--text-light);font-size:12px;font-weight:600;font-family:var(--font);transition:all .15s}
.gran-btn.active{border-color:var(--teal);background:rgba(0,166,153,.06);color:var(--teal)}
.main{max-width:1240px;margin:0 auto;padding:24px 24px 60px}
.tp{}.tp.hidden{display:none}
.kpi-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:14px;margin-bottom:24px}
.kpi-card{background:var(--card);border-radius:14px;padding:22px 20px;border:1px solid var(--border);position:relative;overflow:hidden;transition:all .25s}
.kpi-card:hover{box-shadow:0 6px 24px rgba(0,0,0,.06);transform:translateY(-1px)}
.kpi-accent{position:absolute;top:-8px;right:-8px;width:50px;height:50px;border-radius:50%;opacity:.06}
.kpi-label{font-size:11px;color:var(--text-light);letter-spacing:.06em;text-transform:uppercase;font-weight:600;margin-bottom:5px}
.kpi-value{font-family:var(--display);font-size:28px;font-weight:700;line-height:1.1}
.kpi-sub{font-size:12px;color:var(--text-light);margin-top:6px}
.card{background:var(--card);border-radius:14px;padding:22px;border:1px solid var(--border);margin-bottom:20px}
.card-title{font-family:var(--display);font-size:18px;font-weight:700;margin-bottom:2px}
.card-sub{font-size:13px;color:var(--text-light);margin-bottom:14px}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
.platform-row{display:flex;align-items:center;gap:20px}
.platform-chart{width:45%;min-width:160px}
.platform-details{flex:1}
.platform-item{margin-bottom:12px;padding:12px 14px;background:var(--bg);border-radius:10px}
.platform-name{display:flex;align-items:center;gap:8px;margin-bottom:4px}
.platform-dot{width:10px;height:10px;border-radius:3px}
.platform-name span{font-size:14px;font-weight:600}
.platform-stats{font-size:12px;color:var(--text-light);line-height:1.7}
.data-table{width:100%;border-collapse:collapse;font-size:13px}
.data-table th{padding:10px 12px;text-align:left;font-weight:600;color:var(--text-light);font-size:11px;text-transform:uppercase;letter-spacing:.05em;border-bottom:2px solid var(--border)}
.data-table td{padding:10px 12px;border-bottom:1px solid var(--border-light)}
.data-table tbody tr:hover{background:var(--bg)}
.td-bold{font-weight:700}.td-coral{font-weight:600;color:var(--coral)}.td-teal{font-weight:600;color:var(--teal)}.td-purple{color:var(--purple)}
.insight-item{display:flex;gap:12px;padding:12px 14px;background:var(--bg);border-radius:10px;margin-bottom:10px}
.insight-bar{width:4px;border-radius:2px;flex-shrink:0}
.insight-label{font-size:13px;font-weight:700;margin-bottom:2px}
.insight-detail{font-size:12px;color:var(--text-mid);line-height:1.5}
.highlight-icon{font-size:28px;margin-bottom:8px}
.highlight-label{font-size:11px;color:var(--text-light);text-transform:uppercase;letter-spacing:.06em;font-weight:600;margin-bottom:4px}
.highlight-value{font-family:var(--display);font-size:26px;font-weight:700;margin-bottom:8px}
.highlight-sub{font-size:13px;color:var(--text-mid);line-height:1.6}
.rec-card{padding:20px;border-radius:12px;border-left:3px solid}
.rec-icon{font-size:22px;margin-bottom:8px}.rec-title{font-size:14px;font-weight:700;margin-bottom:6px}.rec-text{font-size:13px;color:var(--text-mid);line-height:1.55}
.ring-wrap{display:flex;align-items:center;justify-content:center;min-height:220px}
.ring-container{text-align:center}.ring-svg{width:140px;height:140px}
.ring-label{position:relative;margin-top:-95px;margin-bottom:48px;font-family:var(--display);font-size:28px;font-weight:700;color:var(--teal)}
.ring-sublabel{font-size:11px;color:var(--text-light);font-family:var(--font);font-weight:400}
.ring-stats{font-size:13px;color:var(--text-mid);margin-top:8px}
.listing-banner{background:linear-gradient(135deg,#1a1a1a,#2d3436);border-radius:14px;padding:24px;margin-bottom:20px;display:flex;align-items:center;gap:20px;color:#fff}
.listing-badge{background:var(--coral);color:#fff;font-size:11px;font-weight:700;padding:3px 8px;border-radius:5px;display:inline-block;margin-bottom:6px}
.listing-title{font-family:var(--display);font-size:22px;font-weight:700;margin-bottom:4px}
.listing-details{font-size:13px;color:rgba(255,255,255,.7);line-height:1.6}
.listing-rating{display:flex;align-items:center;gap:6px;font-size:14px;font-weight:600;margin-top:8px}
.listing-stats{display:flex;gap:28px;margin-left:auto}
.listing-stat-item{text-align:center}
.listing-stat-val{font-family:var(--display);font-size:24px;font-weight:700}
.listing-stat-label{font-size:11px;color:rgba(255,255,255,.6);text-transform:uppercase;letter-spacing:.05em}
.slider-wrap{margin-bottom:0}
.slider-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.slider-title{font-family:var(--display);font-size:18px;font-weight:700}
.slider-value{font-family:var(--display);font-size:32px;font-weight:700;color:var(--coral)}
.slider-desc{font-size:13px;color:var(--text-light);margin-bottom:16px;line-height:1.5}
.slider-input{width:100%;-webkit-appearance:none;appearance:none;height:8px;border-radius:4px;background:linear-gradient(90deg,var(--border) 0%,var(--coral) 100%);outline:none}
.slider-input::-webkit-slider-thumb{-webkit-appearance:none;width:28px;height:28px;border-radius:50%;background:var(--coral);cursor:pointer;border:3px solid #fff;box-shadow:0 2px 8px rgba(255,90,95,.3)}
.slider-input::-moz-range-thumb{width:28px;height:28px;border-radius:50%;background:var(--coral);cursor:pointer;border:3px solid #fff;box-shadow:0 2px 8px rgba(255,90,95,.3)}
.slider-ticks{display:flex;justify-content:space-between;margin-top:8px;font-size:11px;color:var(--text-light)}
.forecast-kpi{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:24px}
.fkpi{background:var(--card);border-radius:14px;padding:20px;border:1px solid var(--border);text-align:center;transition:all .25s}
.fkpi:hover{box-shadow:0 6px 24px rgba(0,0,0,.06)}
.fkpi-label{font-size:11px;color:var(--text-light);text-transform:uppercase;letter-spacing:.06em;font-weight:600;margin-bottom:4px}
.fkpi-value{font-family:var(--display);font-size:26px;font-weight:700}
.fkpi-sub{font-size:12px;color:var(--text-light);margin-top:4px}
.tag-actual{display:inline-block;font-size:10px;font-weight:700;padding:2px 6px;border-radius:4px;background:rgba(0,166,153,.1);color:var(--teal)}
.tag-forecast{display:inline-block;font-size:10px;font-weight:700;padding:2px 6px;border-radius:4px;background:rgba(255,90,95,.1);color:var(--coral)}
@media(max-width:900px){.kpi-grid,.forecast-kpi{grid-template-columns:repeat(2,1fr)}.grid-2,.grid-3{grid-template-columns:1fr}.listing-banner{flex-direction:column;align-items:flex-start}.listing-stats{margin-left:0;margin-top:16px}.header-inner{flex-wrap:wrap;height:auto;padding:12px 16px;gap:10px}}
@media(max-width:600px){.kpi-grid,.forecast-kpi{grid-template-columns:repeat(2,1fr)}.tabs{overflow-x:auto}.tab-btn{padding:7px 12px;font-size:12px;white-space:nowrap}.main{padding:16px 14px 40px}.card{padding:16px}.kpi-card{padding:16px 14px}.kpi-value,.fkpi-value{font-size:22px}.platform-row{flex-direction:column}.platform-chart{width:100%}.data-table{font-size:11px}.data-table th,.data-table td{padding:8px 6px}.listing-stats{gap:16px}.slider-header{flex-direction:column;align-items:flex-start;gap:8px}}
</style>
</head>
<body>
<header class="header"><div class="header-inner">
<div class="logo"><div class="logo-icon">A</div><span class="logo-text">Host Analytics</span></div>
<div class="tabs" id="tabs">
<button class="tab-btn active" data-tab="overview">Overview</button>
<button class="tab-btn" data-tab="revenue">Revenue</button>
<button class="tab-btn" data-tab="guests">Guests</button>
<button class="tab-btn" data-tab="insights">Insights</button>
<button class="tab-btn" data-tab="forecast">Forecast</button>
</div>
<div class="year-filter" id="yearFilter">
<span class="year-label">Year:</span>
<button class="year-btn active" data-year="all">All</button>
<button class="year-btn" data-year="2021">2021</button>
<button class="year-btn" data-year="2022">2022</button>
<button class="year-btn" data-year="2023">2023</button>
<button class="year-btn" data-year="2024">2024</button>
<button class="year-btn" data-year="2025">2025</button>
<button class="year-btn" data-year="2026">2026</button>
</div>
<div class="year-filter" id="granFilter" style="display:none">
<span class="year-label">View:</span>
<button class="gran-btn active" data-gran="monthly">Monthly</button>
<button class="gran-btn" data-gran="weekly">Weekly</button>
<button class="gran-btn" data-gran="annual">Annual</button>
</div>
</div></header>
<main class="main">
<div class="listing-banner"><div>
<span class="listing-badge">‚òÖ SUPERHOST ¬∑ GUEST FAVORITE</span>
<div class="listing-title">Historic Adobe in Barrio Viejo</div>
<div class="listing-details">Tucson, AZ ¬∑ 3 bed ¬∑ 3 bath ¬∑ Sleeps 7 ¬∑ 2,100 sq ft</div>
<div class="listing-rating"><span style="color:var(--gold)">‚òÖ</span> 4.95 ¬∑ 43 reviews ¬∑ 5 years hosting</div>
</div><div class="listing-stats">
<div class="listing-stat-item"><div class="listing-stat-val">192</div><div class="listing-stat-label">Bookings</div></div>
<div class="listing-stat-item"><div class="listing-stat-val">863</div><div class="listing-stat-label">Nights</div></div>
<div class="listing-stat-item"><div class="listing-stat-val">$206K</div><div class="listing-stat-label">Earned</div></div>
</div></div>

<div class="tp" id="tab-overview">
<div class="kpi-grid" id="kpiGrid"></div>
<div class="card"><div class="card-title" id="revTitle">Revenue by Year</div><div class="card-sub" id="revSub">Yearly payout totals</div><div style="height:300px"><canvas id="c1"></canvas></div></div>
<div class="grid-2">
<div class="card"><div class="card-title">Platform Split</div><div class="card-sub">Airbnb vs VRBO breakdown</div><div class="platform-row"><div class="platform-chart"><div style="height:200px"><canvas id="c2"></canvas></div></div><div class="platform-details"><div class="platform-item"><div class="platform-name"><div class="platform-dot" style="background:var(--coral)"></div><span>Airbnb</span></div><div class="platform-stats">173 bookings ¬∑ $174.4K payout<br>748 nights ¬∑ $252/night avg</div></div><div class="platform-item"><div class="platform-name"><div class="platform-dot" style="background:var(--teal)"></div><span>VRBO</span></div><div class="platform-stats">19 bookings ¬∑ $32.0K payout<br>115 nights ¬∑ $374/night avg</div></div></div></div></div>
<div class="card"><div class="card-title">Day of Week Pricing</div><div class="card-sub">Average nightly rate by check-in day</div><div style="height:220px"><canvas id="c3"></canvas></div></div>
</div></div>

<div class="tp" id="tab-revenue">
<div class="card"><div class="card-title">Annual Financial Summary</div><div class="card-sub">Payout, gross payment, and commissions paid by year</div><div style="height:320px"><canvas id="c4"></canvas></div></div>
<div class="grid-2">
<div class="card"><div class="card-title">Nightly Rate Trend</div><div class="card-sub">Net payout per night by year</div><div style="height:240px"><canvas id="c5"></canvas></div></div>
<div class="card"><div class="card-title">Occupancy Volume</div><div class="card-sub">Total guest nights booked per year</div><div style="height:240px"><canvas id="c6"></canvas></div></div>
</div>
<div class="card"><div class="card-title">Year-over-Year Details</div><div class="card-sub">All key financial metrics by year</div><div style="overflow-x:auto"><table class="data-table"><thead><tr><th>Year</th><th>Gross</th><th>Payout</th><th>Commission</th><th>Bookings</th><th>Nights</th><th>Guests</th><th>Avg/Night</th><th>Avg Stay</th></tr></thead><tbody id="yearTable"></tbody></table></div></div>
</div>

<div class="tp" id="tab-guests">
<div class="grid-2">
<div class="card"><div class="card-title">Top Guest States</div><div class="card-sub">Where your guests come from</div><div style="height:280px"><canvas id="c7"></canvas></div></div>
<div class="card"><div class="card-title">Top Guest Cities</div><div class="card-sub">Most frequent guest origin cities</div><div style="height:280px"><canvas id="c8"></canvas></div></div>
</div><div class="grid-2">
<div class="card"><div class="card-title">Guest Volume Trend</div><div class="card-sub">Total guests hosted per year</div><div style="height:240px"><canvas id="c9"></canvas></div></div>
<div class="card"><div class="card-title">Repeat Guest Insight</div><div class="card-sub">8 of 183 unique guests returned (4.4%)</div><div class="ring-wrap"><div class="ring-container"><svg class="ring-svg" viewBox="0 0 36 36"><circle cx="18" cy="18" r="15.9" fill="none" stroke="#F0F0EC" stroke-width="2.5"/><circle cx="18" cy="18" r="15.9" fill="none" stroke="#00A699" stroke-width="2.5" stroke-dasharray="4.4 95.6" stroke-linecap="round" transform="rotate(-90 18 18)"/></svg><div class="ring-label">4.4%<div class="ring-sublabel">repeat</div></div><div class="ring-stats"><strong>183</strong> unique guests ¬∑ <strong>8</strong> returned</div></div></div></div>
</div>
<div class="card"><div class="card-title">Guest Origins ‚Äî US Heat Map</div><div class="card-sub">Revenue by state ‚Äî darker = more revenue</div><div id="usMapWrap" style="width:100%;overflow-x:auto"></div></div>
<div class="card"><div class="card-title">Revenue by Guest</div><div class="card-sub">Top 50 guests ranked by total payout</div>
<div style="overflow-x:auto"><table class="data-table"><thead><tr><th>#</th><th>Guest</th><th>Payout</th><th>Nights</th><th>$/Night</th><th>State</th><th>Bookings</th></tr></thead><tbody id="guestTable"></tbody></table></div></div>
</div>

<div class="tp" id="tab-insights">
<div class="grid-3" style="margin-bottom:20px">
<div class="card"><div class="highlight-icon">üèÜ</div><div class="highlight-label">Best Year</div><div class="highlight-value" style="color:var(--gold)">2024</div><div class="highlight-sub">$41.9K payout from 53 bookings ‚Äî your highest volume year.</div></div>
<div class="card"><div class="highlight-icon">üìà</div><div class="highlight-label">Highest Nightly Rate</div><div class="highlight-value" style="color:var(--teal)">$376/night</div><div class="highlight-sub">2022 and 2026 achieved the highest avg nightly rates.</div></div>
<div class="card"><div class="highlight-icon">üåµ</div><div class="highlight-label">Top Market</div><div class="highlight-value" style="color:var(--coral)">Arizona</div><div class="highlight-sub">38 bookings from AZ guests (20% of all bookings).</div></div>
</div>
<div class="grid-2">
<div class="card"><div class="card-title">Performance Highlights</div><div class="card-sub">Key observations from your booking data</div>
<div class="insight-item"><div class="insight-bar" style="background:var(--coral)"></div><div><div class="insight-label">Platform Mix</div><div class="insight-detail">90% Airbnb, 10% VRBO ‚Äî but VRBO commands $374/night vs Airbnb's $252/night.</div></div></div>
<div class="insight-item"><div class="insight-bar" style="background:var(--teal)"></div><div><div class="insight-label">Seasonality</div><div class="insight-detail">Peak months Feb-Apr and Oct-Dec. Summer (Jun-Aug) consistently lower occupancy.</div></div></div>
<div class="insight-item"><div class="insight-bar" style="background:var(--gold)"></div><div><div class="insight-label">Stay Length</div><div class="insight-detail">Average stay decreased from 7.8 nights (2021) to ~3-4 nights (2024-2026).</div></div></div>
<div class="insight-item"><div class="insight-bar" style="background:var(--purple)"></div><div><div class="insight-label">2024 Growth</div><div class="insight-detail">54.5% YoY revenue jump ‚Äî doubling bookings to 53 with 225 total nights.</div></div></div>
<div class="insight-item"><div class="insight-bar" style="background:#3D5A80"></div><div><div class="insight-label">Repeat Guests</div><div class="insight-detail">Only 4.4% repeat rate. Build loyalty through return-guest discounts.</div></div></div>
</div>
<div class="card"><div class="card-title">Year-over-Year Comparison</div><div class="card-sub">Revenue and volume progression</div><div style="height:300px"><canvas id="c10"></canvas></div></div>
</div>
<div class="card"><div class="card-title">Recommendations</div><div class="card-sub">Data-driven suggestions to grow your rental income</div><div class="grid-3">
<div class="rec-card" style="background:rgba(255,180,0,.06);border-color:var(--gold)"><div class="rec-icon">‚ö°</div><div class="rec-title">Boost Summer Occupancy</div><div class="rec-text">Jun-Aug is your slowest period. Consider lowering rates 15-20%.</div></div>
<div class="rec-card" style="background:rgba(0,166,153,.06);border-color:var(--teal)"><div class="rec-icon">üîÑ</div><div class="rec-title">Increase Repeat Rate</div><div class="rec-text">At 4.4%, huge upside. Send post-stay messages with a 10% return discount.</div></div>
<div class="rec-card" style="background:rgba(145,70,105,.06);border-color:var(--purple)"><div class="rec-icon">üìä</div><div class="rec-title">Grow VRBO Presence</div><div class="rec-text">VRBO averages $374/night vs $252 on Airbnb. Optimize your VRBO listing.</div></div>
</div></div></div>

<div class="tp" id="tab-forecast">
<div class="card slider-wrap">
<div class="slider-header"><div><div class="slider-title">2026 Revenue Forecast</div>
<div class="slider-desc">Adjust the slider to simulate different occupancy scenarios vs your historical average (2021-2025). 100% = match average performance.</div></div>
<div style="text-align:right"><div style="font-size:12px;color:var(--text-light);text-transform:uppercase;letter-spacing:.06em;font-weight:600">Occupancy Rate</div><div class="slider-value" id="sliderVal">100%</div></div></div>
<input type="range" min="0" max="150" value="100" step="5" class="slider-input" id="occSlider">
<div class="slider-ticks"><span>0%</span><span>25%</span><span>50%</span><span>75%</span><span>100%</span><span>125%</span><span>150%</span></div>
</div>
<div class="forecast-kpi" id="forecastKPIs"></div>
<div class="card"><div class="card-title">Monthly Breakdown ‚Äî 2026</div><div class="card-sub" id="fcSub">Actual vs forecasted payout by month</div><div style="height:340px"><canvas id="c11"></canvas></div></div>
<div class="grid-2">
<div class="card"><div class="card-title">Scenario Comparison</div><div class="card-sub">Full-year projected revenue at different occupancy levels</div><div style="height:280px"><canvas id="c12"></canvas></div></div>
<div class="card"><div class="card-title">Forecast vs Prior Years</div><div class="card-sub">How 2026 projected total compares to past years</div><div style="height:280px"><canvas id="c13"></canvas></div></div>
</div>
<div class="card"><div class="card-title">Monthly Forecast Detail</div><div class="card-sub">Breakdown of actual and projected figures</div><div style="overflow-x:auto"><table class="data-table"><thead><tr><th>Month</th><th>Status</th><th>Payout</th><th>Nights</th><th>Bookings</th></tr></thead><tbody id="forecastTable"></tbody></table></div></div>

<div style="height:2px;background:var(--border);margin:32px 0;border-radius:1px"></div>

<div class="card slider-wrap">
<div class="slider-header"><div><div class="slider-title">üí∞ Rate Optimizer</div>
<div class="slider-desc">Based on your historical data, there's an inverse relationship between nightly rate and occupancy. Your price elasticity is <strong>-0.9</strong> (nearly unit elastic), meaning a 10% rate drop typically yields ~9% more nights booked. Use the slider to find your revenue sweet spot.</div></div>
<div style="text-align:right"><div style="font-size:12px;color:var(--text-light);text-transform:uppercase;letter-spacing:.06em;font-weight:600">Nightly Rate</div><div class="slider-value" id="rateVal">$260</div></div></div>
<input type="range" min="100" max="450" value="260" step="10" class="slider-input" id="rateSlider">
<div class="slider-ticks"><span>$100</span><span>$150</span><span>$200</span><span>$250</span><span>$300</span><span>$350</span><span>$400</span><span>$450</span></div>
</div>

<div class="forecast-kpi" id="rateKPIs"></div>

<div class="card"><div class="card-title">Revenue Curve</div><div class="card-sub" id="curveSub">Annual revenue at different nightly rates ‚Äî based on your demand elasticity</div><div style="height:320px"><canvas id="c14"></canvas></div></div>

<div class="grid-2">
<div class="card"><div class="card-title">Rate vs Occupancy Tradeoff</div><div class="card-sub">Historical data points and estimated demand curve</div><div style="height:280px"><canvas id="c15"></canvas></div></div>
<div class="card"><div class="card-title">Break-Even Analysis</div><div class="card-sub">Revenue impact of rate changes from current level</div><div style="height:280px"><canvas id="c16"></canvas></div></div>
</div>

<div class="card">
<div class="card-title">Rate Optimization Detail</div><div class="card-sub">Projected annual outcomes at selected rate vs alternatives</div>
<div style="overflow-x:auto"><table class="data-table"><thead><tr><th>Nightly Rate</th><th>Est. Nights</th><th>Occupancy</th><th>Est. Revenue</th><th>vs Current</th><th>Note</th></tr></thead><tbody id="rateTable"></tbody></table></div>
</div>
</div>
</main>
<script>
/*DATA*/
var MD=[{y:2021,m:1,p:2351.18,n:16,g:5,b:2},{y:2021,m:2,p:4006.45,n:31,g:3,b:1},{y:2021,m:3,p:4969.11,n:29,g:14,b:3},{y:2021,m:4,p:7485.69,n:25,g:16,b:5},{y:2021,m:5,p:2693.30,n:12,g:15,b:3},{y:2021,m:6,p:933.79,n:4,g:6,b:1},{y:2021,m:7,p:280.01,n:2,g:3,b:1},{y:2021,m:10,p:15757.94,n:80,g:19,b:5},{y:2021,m:11,p:1892.48,n:7,g:16,b:4},{y:2021,m:12,p:3905.92,n:13,g:12,b:3},{y:2022,m:1,p:4813.02,n:16,g:12,b:3},{y:2022,m:2,p:10318.80,n:26,g:20,b:5},{y:2022,m:3,p:8884.61,n:24,g:35,b:7},{y:2022,m:4,p:5252.57,n:14,g:19,b:5},{y:2022,m:5,p:2646.64,n:7,g:5,b:2},{y:2022,m:10,p:823.28,n:2,g:2,b:1},{y:2023,m:1,p:1192.66,n:6,g:3,b:2},{y:2023,m:2,p:3594.66,n:11,g:12,b:3},{y:2023,m:3,p:4703.50,n:13,g:12,b:4},{y:2023,m:4,p:3335.02,n:9,g:19,b:3},{y:2023,m:5,p:672.93,n:2,g:6,b:1},{y:2023,m:6,p:1479.00,n:4,g:1,b:1},{y:2023,m:7,p:419.37,n:5,g:3,b:2},{y:2023,m:8,p:1290.17,n:12,g:18,b:2},{y:2023,m:9,p:2677.71,n:31,g:9,b:2},{y:2023,m:10,p:2079.38,n:17,g:16,b:4},{y:2023,m:11,p:2954.07,n:15,g:24,b:5},{y:2023,m:12,p:2745.60,n:24,g:16,b:4},{y:2024,m:1,p:5724.53,n:29,g:37,b:8},{y:2024,m:2,p:4895.06,n:19,g:15,b:5},{y:2024,m:3,p:4739.40,n:24,g:19,b:7},{y:2024,m:4,p:5024.18,n:27,g:15,b:6},{y:2024,m:5,p:2754.25,n:22,g:21,b:5},{y:2024,m:6,p:1142.40,n:13,g:16,b:3},{y:2024,m:7,p:1904.48,n:16,g:7,b:3},{y:2024,m:8,p:1568.25,n:15,g:13,b:3},{y:2024,m:9,p:3350.12,n:20,g:5,b:3},{y:2024,m:10,p:2117.25,n:12,g:20,b:4},{y:2024,m:11,p:2377.69,n:10,g:19,b:3},{y:2024,m:12,p:6327.51,n:18,g:20,b:3},{y:2025,m:1,p:2008.67,n:7,g:6,b:2},{y:2025,m:2,p:7209.24,n:20,g:27,b:6},{y:2025,m:3,p:6323.60,n:21,g:41,b:8},{y:2025,m:4,p:3504.67,n:14,g:23,b:5},{y:2025,m:5,p:3320.08,n:9,g:8,b:3},{y:2025,m:8,p:579.09,n:3,g:5,b:1},{y:2025,m:9,p:2535.07,n:11,g:9,b:3},{y:2025,m:10,p:718.97,n:2,g:6,b:1},{y:2025,m:11,p:5662.36,n:15,g:22,b:5},{y:2025,m:12,p:3514.50,n:11,g:9,b:3},{y:2026,m:1,p:3427.23,n:10,g:6,b:2},{y:2026,m:2,p:10447.44,n:24,g:30,b:6},{y:2026,m:3,p:6589.31,n:19,g:18,b:5},{y:2026,m:4,p:1508.45,n:5,g:10,b:2},{y:2026,m:5,p:905.88,n:3,g:4,b:1},{y:2026,m:7,p:602.57,n:2,g:8,b:1},{y:2026,m:8,p:1513.10,n:5,g:4,b:1}];
var YD=[{year:2021,payout:44275.87,payment:62462.84,nights:219,guests:109,bookings:28,avgNight:248.36,commission:2240.90},{year:2022,payout:32738.92,payment:47945.31,nights:89,guests:93,bookings:23,avgNight:376.37,commission:1302.07},{year:2023,payout:27144.07,payment:42697.38,nights:149,guests:139,bookings:33,avgNight:200.79,commission:4975.29},{year:2024,payout:41925.12,payment:64297.07,nights:225,guests:207,bookings:53,avgNight:192.56,commission:8775.41},{year:2025,payout:35376.25,payment:54558.59,nights:113,guests:156,bookings:37,avgNight:311.43,commission:1339.83},{year:2026,payout:24993.98,payment:35997.14,nights:68,guests:80,bookings:18,avgNight:376.15,commission:846.42}];
var MO=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
var CL={coral:'#FF5A5F',teal:'#00A699',gold:'#FFB400',purple:'#914669'};
var CC=['#FF5A5F','#00A699','#FFB400','#914669','#3D5A80','#EE6C4D'];
var WD=[{y:2021,w:4,p:4006.45,n:31,g:3,b:1},{y:2021,w:8,p:1371.26,n:5,g:3,b:1},{y:2021,w:9,p:3597.85,n:24,g:11,b:2},{y:2021,w:13,p:1553.3,n:6,g:7,b:2},{y:2021,w:14,p:4298.21,n:12,g:6,b:2},{y:2021,w:16,p:1634.18,n:7,g:3,b:1},{y:2021,w:17,p:623.39,n:2,g:5,b:1},{y:2021,w:19,p:623.31,n:4,g:5,b:1},{y:2021,w:20,p:442.97,n:2,g:2,b:1},{y:2021,w:21,p:1003.63,n:4,g:3,b:1},{y:2021,w:22,p:933.79,n:4,g:6,b:1},{y:2021,w:29,p:13491.82,n:73,g:5,b:2},{y:2021,w:40,p:492.99,n:2,g:4,b:1},{y:2021,w:41,p:422.77,n:2,g:5,b:1},{y:2021,w:42,p:462.37,n:2,g:4,b:1},{y:2021,w:43,p:1168.0,n:3,g:4,b:1},{y:2021,w:44,p:698.08,n:3,g:4,b:1},{y:2021,w:45,p:516.69,n:2,g:8,b:1},{y:2021,w:46,p:677.71,n:2,g:4,b:1},{y:2021,w:47,p:2081.42,n:8,g:5,b:1},{y:2021,w:50,p:708.0,n:2,g:4,b:1},{y:2021,w:51,p:1116.5,n:3,g:3,b:1},{y:2021,w:53,p:2351.18,n:16,g:5,b:2},{y:2022,w:1,p:1132.05,n:3,g:3,b:1},{y:2022,w:2,p:840.57,n:3,g:2,b:1},{y:2022,w:4,p:1021.89,n:3,g:3,b:1},{y:2022,w:5,p:4222.86,n:11,g:8,b:2},{y:2022,w:6,p:2328.67,n:5,g:4,b:1},{y:2022,w:7,p:2562.85,n:7,g:4,b:1},{y:2022,w:8,p:1204.42,n:3,g:4,b:1},{y:2022,w:9,p:2464.13,n:7,g:12,b:2},{y:2022,w:10,p:2096.5,n:5,g:9,b:2},{y:2022,w:11,p:2394.32,n:7,g:5,b:1},{y:2022,w:12,p:1055.04,n:2,g:6,b:1},{y:2022,w:13,p:1870.82,n:5,g:7,b:2},{y:2022,w:14,p:1352.83,n:4,g:6,b:1},{y:2022,w:15,p:1560.41,n:4,g:3,b:1},{y:2022,w:16,p:1343.13,n:4,g:6,b:1},{y:2022,w:18,p:1520.79,n:4,g:3,b:1},{y:2022,w:19,p:1125.85,n:3,g:2,b:1},{y:2022,w:40,p:823.28,n:2,g:2,b:1},{y:2022,w:52,p:1818.51,n:7,g:4,b:1},{y:2023,w:6,p:1371.77,n:4,g:8,b:1},{y:2023,w:7,p:2222.89,n:7,g:4,b:1},{y:2023,w:10,p:1484.82,n:4,g:5,b:1},{y:2023,w:11,p:3218.68,n:9,g:7,b:2},{y:2023,w:13,p:1114.28,n:3,g:8,b:1},{y:2023,w:15,p:1326.71,n:4,g:7,b:1},{y:2023,w:16,p:894.03,n:2,g:4,b:1},{y:2023,w:19,p:672.93,n:2,g:6,b:1},{y:2023,w:25,p:1479.0,n:4,g:1,b:1},{y:2023,w:30,p:419.37,n:5,g:3,b:1},{y:2023,w:31,p:175.8,n:2,g:5,b:1},{y:2023,w:32,p:309.88,n:4,g:6,b:1},{y:2023,w:33,p:804.49,n:6,g:7,b:2},{y:2023,w:35,p:1161.62,n:10,g:6,b:1},{y:2023,w:36,p:1516.09,n:21,g:3,b:1},{y:2023,w:39,p:719.77,n:5,g:9,b:2},{y:2023,w:40,p:521.64,n:6,g:2,b:1},{y:2023,w:41,p:297.15,n:2,g:2,b:1},{y:2023,w:43,p:540.82,n:4,g:3,b:1},{y:2023,w:44,p:359.93,n:2,g:5,b:1},{y:2023,w:45,p:445.51,n:4,g:9,b:2},{y:2023,w:46,p:609.1,n:3,g:4,b:1},{y:2023,w:47,p:1539.53,n:6,g:6,b:1},{y:2023,w:48,p:556.12,n:7,g:3,b:1},{y:2023,w:49,p:411.74,n:6,g:9,b:2},{y:2023,w:50,p:1237.7,n:8,g:2,b:1},{y:2023,w:51,p:540.04,n:3,g:2,b:1},{y:2023,w:52,p:1192.66,n:6,g:3,b:1},{y:2024,w:1,p:2054.98,n:12,g:15,b:3},{y:2024,w:2,p:865.7,n:4,g:3,b:1},{y:2024,w:3,p:620.27,n:4,g:10,b:2},{y:2024,w:4,p:2183.58,n:9,g:9,b:2},{y:2024,w:5,p:1470.21,n:3,g:3,b:1},{y:2024,w:6,p:1477.06,n:7,g:2,b:1},{y:2024,w:7,p:738.44,n:3,g:2,b:1},{y:2024,w:8,p:2528.64,n:11,g:14,b:3},{y:2024,w:10,p:2230.04,n:13,g:7,b:2},{y:2024,w:11,p:1190.07,n:6,g:6,b:1},{y:2024,w:12,p:3013.58,n:14,g:3,b:1},{y:2024,w:15,p:669.13,n:4,g:6,b:1},{y:2024,w:16,p:949.73,n:5,g:5,b:2},{y:2024,w:17,p:391.74,n:4,g:1,b:1},{y:2024,w:18,p:419.26,n:3,g:3,b:1},{y:2024,w:19,p:1209.06,n:10,g:5,b:1},{y:2024,w:20,p:467.37,n:3,g:6,b:1},{y:2024,w:21,p:658.56,n:6,g:7,b:2},{y:2024,w:22,p:516.84,n:6,g:6,b:1},{y:2024,w:24,p:402.96,n:3,g:3,b:1},{y:2024,w:25,p:222.6,n:4,g:7,b:2},{y:2024,w:27,p:620.24,n:6,g:2,b:1},{y:2024,w:29,p:439.74,n:5,g:2,b:1},{y:2024,w:30,p:844.5,n:5,g:3,b:1},{y:2024,w:31,p:257.46,n:3,g:3,b:1},{y:2024,w:32,p:532.06,n:5,g:4,b:1},{y:2024,w:33,p:778.73,n:7,g:6,b:1},{y:2024,w:35,p:1439.82,n:8,g:2,b:1},{y:2024,w:36,p:1910.3,n:12,g:3,b:1},{y:2024,w:40,p:538.06,n:4,g:3,b:1},{y:2024,w:41,p:512.06,n:3,g:1,b:1},{y:2024,w:42,p:634.58,n:3,g:10,b:2},{y:2024,w:43,p:432.55,n:2,g:6,b:1},{y:2024,w:45,p:938.57,n:5,g:3,b:1},{y:2024,w:46,p:249.2,n:1,g:5,b:1},{y:2024,w:47,p:618.39,n:2,g:6,b:1},{y:2024,w:48,p:1220.66,n:4,g:12,b:2},{y:2024,w:49,p:1315.03,n:5,g:2,b:1},{y:2024,w:51,p:2245.58,n:6,g:9,b:2},{y:2024,w:52,p:2117.77,n:5,g:2,b:1},{y:2025,w:2,p:183.04,n:1,g:1,b:1},{y:2025,w:3,p:891.62,n:3,g:3,b:1},{y:2025,w:4,p:934.01,n:3,g:2,b:1},{y:2025,w:5,p:2854.51,n:8,g:9,b:2},{y:2025,w:6,p:1233.46,n:3,g:9,b:2},{y:2025,w:7,p:1830.69,n:5,g:7,b:2},{y:2025,w:8,p:1290.58,n:4,g:2,b:1},{y:2025,w:9,p:958.26,n:3,g:6,b:1},{y:2025,w:10,p:922.57,n:4,g:8,b:2},{y:2025,w:11,p:1659.15,n:6,g:13,b:3},{y:2025,w:12,p:2052.62,n:6,g:10,b:2},{y:2025,w:13,p:731.0,n:2,g:4,b:1},{y:2025,w:14,p:1613.75,n:6,g:10,b:2},{y:2025,w:15,p:389.95,n:2,g:4,b:1},{y:2025,w:16,p:618.37,n:3,g:4,b:1},{y:2025,w:17,p:882.6,n:3,g:5,b:1},{y:2025,w:18,p:2186.25,n:5,g:3,b:1},{y:2025,w:20,p:1133.83,n:4,g:5,b:1},{y:2025,w:31,p:579.09,n:3,g:5,b:1},{y:2025,w:35,p:1000.94,n:4,g:6,b:1},{y:2025,w:37,p:1534.13,n:7,g:3,b:1},{y:2025,w:41,p:718.97,n:2,g:6,b:1},{y:2025,w:44,p:1177.48,n:3,g:6,b:1},{y:2025,w:45,p:973.68,n:3,g:6,b:1},{y:2025,w:47,p:3511.2,n:9,g:10,b:2},{y:2025,w:49,p:614.69,n:3,g:2,b:1},{y:2025,w:52,p:2899.81,n:8,g:7,b:2},{y:2026,w:3,p:1587.53,n:4,g:3,b:1},{y:2026,w:4,p:1839.7,n:6,g:3,b:1},{y:2026,w:5,p:1597.0,n:3,g:6,b:1},{y:2026,w:6,p:3538.25,n:7,g:9,b:2},{y:2026,w:7,p:3204.1,n:7,g:8,b:2},{y:2026,w:8,p:2108.09,n:7,g:7,b:2},{y:2026,w:9,p:2929.2,n:9,g:5,b:1},{y:2026,w:11,p:2049.51,n:6,g:4,b:1},{y:2026,w:12,p:835.37,n:2,g:3,b:1},{y:2026,w:13,p:775.23,n:2,g:6,b:1},{y:2026,w:14,p:602.57,n:2,g:4,b:1},{y:2026,w:15,p:905.88,n:3,g:6,b:1},{y:2026,w:20,p:905.88,n:3,g:4,b:1},{y:2026,w:29,p:602.57,n:2,g:8,b:1},{y:2026,w:34,p:1513.1,n:5,g:4,b:1}];
var GD=[{n:"Patricia Kamimoto",p:13211.81,ni:71,st:"AZ",bk:1},{n:"Monica Papp",p:4006.45,ni:31,st:"AZ",bk:1},{n:"Suzanne Oliver",p:3671.07,ni:9,st:"WA",bk:2},{n:"Chris Martin",p:3097.84,ni:9,st:"WA",bk:3},{n:"Wanda Tucker",p:3048.18,ni:22,st:"FL",bk:1},{n:"Sophie Daley",p:3013.58,ni:14,st:"MA",bk:1},{n:"Dan Cogan",p:2935.02,ni:7,st:"NY",bk:1},{n:"Jennifer Ortale",p:2929.2,ni:9,st:"MN",bk:1},{n:"Jennifer Maynes",p:2887.12,ni:8,st:"CO",bk:2},{n:"Amy Zeng",p:2850.58,ni:8,st:"CA",bk:1},{n:"Susan Strauss",p:2562.85,ni:7,st:"MA",bk:1},{n:"Anne Dietrich",p:2394.32,ni:7,st:"MD",bk:1},{n:"Butch Larcombe",p:2328.67,ni:5,st:"MT",bk:1},{n:"Ross Brunner",p:2256.12,ni:6,st:"CO",bk:1},{n:"Michelle Mriza",p:2222.89,ni:7,st:"NY",bk:1},{n:"Linda Cory Allen",p:2117.77,ni:5,st:"CA",bk:1},{n:"Donald Huffman",p:2081.42,ni:8,st:"VT",bk:1},{n:"LaTosha Taves",p:2074.02,ni:5,st:"AZ",bk:2},{n:"Colleen O'Connell",p:2049.51,ni:6,st:"NY",bk:1},{n:"Hannah Campbell",p:2038.69,ni:6,st:"CA",bk:1},{n:"Jonathan Rauch",p:1993.25,ni:4,st:"MI",bk:1},{n:"Suzanne Musetto",p:1910.3,ni:12,st:"AZ",bk:1},{n:"Ute Moll",p:1880.73,ni:5,st:"NY",bk:1},{n:"Keith Taylor",p:1859.39,ni:4,st:"UK",bk:1},{n:"Meg McMahon",p:1839.7,ni:6,st:"RI",bk:1},{n:"Lynne Harty",p:1818.51,ni:7,st:"NC",bk:1},{n:"Jonathan Blank",p:1810.03,ni:24,st:"NY",bk:2},{n:"Mora Segal",p:1717.7,ni:4,st:"DC",bk:1},{n:"Jean P",p:1682.85,ni:5,st:"NY",bk:1},{n:"Leigh Gibson",p:1646.98,ni:8,st:"NY",bk:1},{n:"Josh Chaiken",p:1634.18,ni:7,st:"NY",bk:1},{n:"Josh Jones",p:1597.0,ni:3,st:"MT",bk:1},{n:"Sue Sternberg",p:1587.53,ni:4,st:"UT",bk:1},{n:"Suzi Myers",p:1545.0,ni:3,st:"CO",bk:1},{n:"Isabel Hees",p:1539.53,ni:6,st:"AZ",bk:1},{n:"Bryan Gock",p:1534.13,ni:7,st:"CO",bk:1},{n:"Carol Ezrati",p:1520.79,ni:4,st:"CA",bk:1},{n:"Cynthia Lasater",p:1513.1,ni:5,st:"OK",bk:1},{n:"Deborah Levesque",p:1477.06,ni:7,st:"AZ",bk:1},{n:"Claire Kelly",p:1474.08,ni:4,st:"AZ",bk:1},{n:"Matt Spiers",p:1470.21,ni:3,st:"AZ",bk:1},{n:"Nicole Lombardo",p:1452.31,ni:11,st:"AZ",bk:1},{n:"Spring Graff",p:1447.63,ni:4,st:"AZ",bk:1},{n:"Erin Hanna",p:1439.82,ni:8,st:"MA",bk:1},{n:"Angel Jenner",p:1371.77,ni:4,st:"CA",bk:1},{n:"Matt Chumley",p:1371.26,ni:5,st:"TN",bk:1},{n:"Brittany McKnight",p:1352.83,ni:4,st:"AZ",bk:1},{n:"Jake Montgomery",p:1344.71,ni:3,st:"NY",bk:1},{n:"Rosie Dwyer",p:1343.13,ni:4,st:"CA",bk:1},{n:"Nick & Sylvie Light",p:1322.01,ni:4,st:"OR",bk:1}];
var SD=[{s:"AZ",p:55452.61,b:51,n:261},{s:"NY",p:24832.17,b:20,n:100},{s:"CA",p:23393.78,b:24,n:83},{s:"CO",p:14243.15,b:13,n:51},{s:"WA",p:12854.81,b:14,n:48},{s:"MA",p:11370.74,b:10,n:50},{s:"TX",p:9994.5,b:12,n:46},{s:"MT",p:8658.01,b:7,n:50},{s:"FL",p:6401.28,b:7,n:38},{s:"MD",p:3735.49,b:3,n:13},{s:"NC",p:3376.08,b:4,n:16},{s:"MI",p:3283.83,b:2,n:8},{s:"MN",p:2929.2,b:1,n:9},{s:"UT",p:2704.03,b:2,n:7},{s:"NV",p:2324.5,b:3,n:9},{s:"DC",p:2140.47,b:2,n:6},{s:"VT",p:2081.42,b:1,n:8},{s:"RI",p:1839.7,b:1,n:6},{s:"NM",p:1586.53,b:2,n:5},{s:"OK",p:1513.1,b:1,n:5},{s:"TN",p:1371.26,b:1,n:5},{s:"OR",p:1322.01,b:1,n:4},{s:"PA",p:1315.03,b:1,n:5},{s:"IL",p:1187.93,b:1,n:4},{s:"KS",p:973.68,b:1,n:3},{s:"IA",p:280.01,b:1,n:2}];
var PD={2021:{ab:20,ap:29438,an:144,vb:8,vp:14838,vn:75},2022:{ab:19,ap:26761,an:75,vb:4,vp:5978,vn:14},2023:{ab:31,ap:25070,an:144,vb:2,vp:2074,vn:5},2024:{ab:51,ap:38090,an:216,vb:2,vp:3835,vn:9},2025:{ab:36,ap:33190,an:108,vb:1,vp:2186,vn:5},2026:{ab:16,ap:21861,an:61,vb:2,vp:3133,vn:7}};
var DD={2021:[152,279,191,389,252,208,164],2022:[309,260,348,365,400,398,418],2023:[128,199,188,282,136,278,82],2024:[127,159,179,241,188,189,227],2025:[0,374,282,312,290,298,321],2026:[486,0,0,397,352,325,227]};var DD_ALL=[169,245,225,319,246,236,237];
var SBY={"2021":[{s:"AZ",p:24264,b:10},{s:"CA",p:4209,b:4},{s:"FL",p:3048,b:1},{s:"NY",p:2638,b:2},{s:"VT",p:2081,b:1},{s:"WA",p:1824,b:3},{s:"TN",p:1371,b:1},{s:"IL",p:1188,b:1},{s:"UT",p:1117,b:1},{s:"CO",p:899,b:1}],"2022":[{s:"AZ",p:5868,b:5},{s:"MA",p:4585,b:3},{s:"NY",p:4223,b:2},{s:"CA",p:4143,b:3},{s:"TX",p:2686,b:3},{s:"CO",p:2435,b:2},{s:"MD",p:2394,b:1},{s:"MT",p:2329,b:1},{s:"NC",p:1819,b:1},{s:"FL",p:1132,b:1}],"2023":[{s:"AZ",p:5823,b:8},{s:"CA",p:5136,b:5},{s:"NY",p:3678,b:3},{s:"WA",p:3504,b:3},{s:"CO",p:2220,b:3},{s:"TX",p:2013,b:3},{s:"MT",p:1516,b:1},{s:"MA",p:1261,b:3},{s:"NC",p:419,b:1}],"2024":[{s:"AZ",p:10055,b:15},{s:"MA",p:5525,b:4},{s:"TX",p:4565,b:5},{s:"NY",p:4354,b:6},{s:"CA",p:4211,b:5},{s:"WA",p:2982,b:4},{s:"MT",p:2486,b:3},{s:"PA",p:2340,b:2},{s:"CO",p:1777,b:2},{s:"DC",p:1718,b:1}],"2025":[{s:"AZ",p:7228,b:10},{s:"CA",p:5695,b:7},{s:"CO",p:5367,b:4},{s:"NY",p:4741,b:3},{s:"WA",p:2512,b:2},{s:"NV",p:1417,b:2},{s:"OR",p:1322,b:1},{s:"MI",p:1291,b:1},{s:"NM",p:1172,b:1},{s:"NC",p:1138,b:2}],"2026":[{s:"NY",p:5198,b:4},{s:"MN",p:2929,b:1},{s:"AZ",p:2213,b:3},{s:"MI",p:1993,b:1},{s:"RI",p:1840,b:1},{s:"MT",p:1597,b:1},{s:"UT",p:1588,b:1},{s:"CO",p:1545,b:1},{s:"OK",p:1513,b:1},{s:"NV",p:907,b:1}]};
var CBY={"2021":[{c:"Tucson",b:3},{c:"Miami",b:1},{c:"San Francisco",b:1},{c:"New York",b:2},{c:"Stowe",b:1},{c:"Phoenix",b:2},{c:"Flagstaff",b:1},{c:"Seattle",b:2}],"2022":[{c:"Ithaca",b:1},{c:"Salem",b:1},{c:"Tempe",b:2},{c:"Baltimore",b:1},{c:"Tucson",b:2},{c:"Billings",b:1},{c:"Dallas",b:2},{c:"Asheville",b:1}],"2023":[{c:"Seattle",b:3},{c:"Phoenix",b:4},{c:"New York",b:2},{c:"Los Angeles",b:2},{c:"Tucson",b:2},{c:"Dallas",b:2},{c:"Durango",b:2},{c:"Billings",b:1}],"2024":[{c:"Phoenix",b:6},{c:"San Diego",b:3},{c:"Tempe",b:4},{c:"Salem",b:1},{c:"Seattle",b:3},{c:"Boston",b:3},{c:"Billings",b:3},{c:"Ithaca",b:3}],"2025":[{c:"Phoenix",b:5},{c:"New York",b:2},{c:"Seattle",b:2},{c:"Denver",b:2},{c:"Colo Springs",b:1},{c:"Las Vegas",b:2},{c:"Eugene",b:1},{c:"Lansing",b:1}],"2026":[{c:"Minneapolis",b:1},{c:"Schenectady",b:1},{c:"Traverse City",b:1},{c:"London",b:1},{c:"Charlestown",b:1},{c:"New York",b:2},{c:"Bozeman",b:1},{c:"Moab",b:1}]};
var GBY={"2021":[{n:"Patricia Kamimoto",p:13212,ni:71,st:"AZ",bk:1},{n:"Monica Papp",p:4006,ni:31,st:"AZ",bk:1},{n:"Wanda Tucker",p:3048,ni:22,st:"FL",bk:1},{n:"Amy Zeng",p:2851,ni:8,st:"CA",bk:1},{n:"Donald Huffman",p:2081,ni:8,st:"VT",bk:1}],"2022":[{n:"Dan Cogan",p:2935,ni:7,st:"NY",bk:1},{n:"Susan Strauss",p:2563,ni:7,st:"MA",bk:1},{n:"Anne Dietrich",p:2394,ni:7,st:"MD",bk:1},{n:"Butch Larcombe",p:2329,ni:5,st:"MT",bk:1},{n:"Lynne Harty",p:1819,ni:7,st:"NC",bk:1}],"2023":[{n:"Michelle Mriza",p:2223,ni:7,st:"NY",bk:1},{n:"LaTosha Taves",p:2074,ni:5,st:"AZ",bk:2},{n:"Hannah Campbell",p:2039,ni:6,st:"CA",bk:1},{n:"Jonathan Blank",p:1810,ni:24,st:"NY",bk:2},{n:"Isabel Hees",p:1540,ni:6,st:"AZ",bk:1}],"2024":[{n:"Sophie Daley",p:3014,ni:14,st:"MA",bk:1},{n:"Linda Cory Allen",p:2118,ni:5,st:"CA",bk:1},{n:"Suzanne Musetto",p:1910,ni:12,st:"AZ",bk:1},{n:"Mora Segal",p:1718,ni:4,st:"DC",bk:1},{n:"Leigh Gibson",p:1647,ni:8,st:"NY",bk:1}],"2025":[{n:"Ross Brunner",p:2256,ni:6,st:"CO",bk:1},{n:"Suzanne Oliver",p:2186,ni:5,st:"WA",bk:1},{n:"Ute Moll",p:1881,ni:5,st:"NY",bk:1},{n:"Jean P",p:1683,ni:5,st:"NY",bk:1},{n:"Bryan Gock",p:1534,ni:7,st:"CO",bk:1}],"2026":[{n:"Jennifer Ortale",p:2929,ni:9,st:"MN",bk:1},{n:"Colleen O'Connell",p:2050,ni:6,st:"NY",bk:1},{n:"Jonathan Rauch",p:1993,ni:4,st:"MI",bk:1},{n:"Keith Taylor",p:1859,ni:4,st:"UK",bk:1},{n:"Meg McMahon",p:1840,ni:6,st:"RI",bk:1}]};
var A26={1:3427.23,2:10447.44,3:6589.31,4:1508.45,5:905.88,7:602.57,8:1513.10};var AN26={1:10,2:24,3:19,4:5,5:3,7:2,8:5};var AB26={1:2,2:7,3:4,4:2,5:1,7:1,8:1};
var HA={1:3218.01,2:6004.84,3:5924.04,4:4920.43,5:2417.44,6:1185.06,7:867.95,8:1145.84,9:2854.30,10:4299.36,11:3221.65,12:4123.38};var HN={1:14.8,2:21.4,3:22.2,4:17.8,5:10.4,6:7.0,7:7.7,8:10.0,9:20.7,10:22.6,11:11.8,12:16.5};var HB={1:3.6,2:4.0,3:5.2,4:4.4,5:2.8,6:2.0,7:1.7,8:2.7,9:2.0,10:3.4,11:4.0,12:4.0};
var selYear='all';var selGran='monthly';var ch={};
Chart.defaults.font.family="'DM Sans',sans-serif";Chart.defaults.font.size=12;Chart.defaults.color='#8B8B8B';Chart.defaults.plugins.legend.display=false;
function $(id){return document.getElementById(id)}
function fmt(n){return n>=1000?'$'+(n/1000).toFixed(0)+'k':'$'+n}
function fmtF(n){return '$'+n.toLocaleString(undefined,{maximumFractionDigits:0})}
function tot(yr){var d=yr==='all'?YD:YD.filter(function(y){return y.year==yr});var p=0,pay=0,n=0,g=0,b=0;for(var i=0;i<d.length;i++){p+=d[i].payout;pay+=d[i].payment;n+=d[i].nights;g+=d[i].guests;b+=d[i].bookings}return{p:p,pay:pay,n:n,g:g,b:b,an:p/Math.max(n,1),as:n/Math.max(b,1)}}
function nk(k){if(ch[k]){ch[k].destroy();ch[k]=null}}
function cd(yr){
if(yr==='all')return YD.map(function(y){return{l:String(y.year),p:y.payout,b:y.bookings,n:y.nights,g:y.guests}});
if(selGran==='annual'){var yd=null;for(var i=0;i<YD.length;i++){if(YD[i].year==yr)yd=YD[i]}return yd?[{l:String(yr),p:yd.payout,b:yd.bookings,n:yd.nights,g:yd.guests}]:[]}
if(selGran==='weekly'){
var lookup={};WD.filter(function(r){return r.y==yr}).forEach(function(r){lookup[r.w]=r});
var out=[];for(var w=1;w<=52;w++){var d=lookup[w];out.push({l:'W'+w,p:d?d.p:0,b:d?d.b:0,n:d?d.n:0,g:d?d.g:0})}return out}
return MO.map(function(m,i){var d=null;for(var j=0;j<MD.length;j++){if(MD[j].y==yr&&MD[j].m===i+1){d=MD[j];break}}return{l:m,p:d?d.p:0,b:d?d.b:0,n:d?d.n:0,g:d?d.g:0}})}
function granLabel(){return selGran==='weekly'?'Weekly':selGran==='annual'?'Annual summary':'Monthly'}
function updateGranVisibility(){$('granFilter').style.display=selYear==='all'?'none':'flex'}
function renderKPIs(){var t=tot(selYear);$('kpiGrid').innerHTML=[{l:'Total Payout',v:'$'+(t.p/1000).toFixed(1)+'K',s:'of $'+(t.pay/1000).toFixed(0)+'K gross',c:CL.coral},{l:'Bookings',v:t.b,s:t.g+' total guests',c:CL.teal},{l:'Nights Booked',v:t.n,s:t.as.toFixed(1)+' avg stay',c:CL.gold},{l:'Avg / Night',v:'$'+t.an.toFixed(0),s:'net payout rate',c:CL.purple},{l:'Guests / Booking',v:(t.g/Math.max(t.b,1)).toFixed(1),s:'avg group size',c:'#3D5A80'}].map(function(k){return '<div class="kpi-card"><div class="kpi-accent" style="background:'+k.c+'"></div><div class="kpi-label">'+k.l+'</div><div class="kpi-value">'+k.v+'</div><div class="kpi-sub">'+k.s+'</div></div>'}).join('')}
function r1(){var d=cd(selYear);var sub=selYear==='all'?'Yearly payout totals':granLabel()+' breakdown for '+selYear;$('revTitle').textContent=selYear==='all'?'Revenue by Year':selYear+' Revenue';$('revSub').textContent=sub;nk('r1');var fontSize=selGran==='weekly'?9:12;ch.r1=new Chart($('c1'),{type:'bar',data:{labels:d.map(function(x){return x.l}),datasets:[{label:'Payout',data:d.map(function(x){return x.p}),type:selGran==='weekly'?'bar':'line',borderColor:CL.coral,backgroundColor:selGran==='weekly'?CL.coral:'rgba(255,90,95,0.08)',borderWidth:selGran==='weekly'?0:2.5,fill:true,tension:0.3,pointRadius:selGran==='weekly'?0:4,pointBackgroundColor:CL.coral,pointBorderColor:'#fff',pointBorderWidth:2,borderRadius:selGran==='weekly'?2:0,barPercentage:selGran==='weekly'?0.9:0.5,yAxisID:'y'},{label:'Bookings',data:d.map(function(x){return x.b}),backgroundColor:'rgba(0,166,153,0.6)',borderRadius:6,barPercentage:0.5,yAxisID:'y1'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:true,position:'top',labels:{usePointStyle:true,padding:16,font:{size:12}}}},scales:{y:{position:'left',grid:{color:'#F0F0EC'},ticks:{callback:function(v){return fmt(v)}}},y1:{position:'right',grid:{display:false},ticks:{stepSize:1}},x:{grid:{display:false},ticks:{font:{size:fontSize},maxRotation:selGran==='weekly'?90:0}}}}})}
function r2(){nk('r2');var pd=selYear==='all'?{ab:173,ap:174400,an:748,vb:19,vp:32000,vn:115}:PD[selYear];ch.r2=new Chart($('c2'),{type:'doughnut',data:{labels:['Airbnb','VRBO'],datasets:[{data:[pd.ab,pd.vb],backgroundColor:[CL.coral,CL.teal],borderWidth:0,spacing:4}]},options:{responsive:true,maintainAspectRatio:false,cutout:'62%'}})}
function r3(){nk('r3');var dd=selYear==='all'?DD_ALL:DD[selYear];ch.r3=new Chart($('c3'),{type:'bar',data:{labels:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],datasets:[{label:'Avg/Night',data:dd,backgroundColor:CL.gold,borderRadius:6,barPercentage:0.55}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{grid:{color:'#F0F0EC'},ticks:{callback:function(v){return '$'+v}}},x:{grid:{display:false}}}}})}
function r4(){var d=cd(selYear);var fontSize=selGran==='weekly'?9:12;nk('r4');ch.r4=new Chart($('c4'),{type:'bar',data:{labels:d.map(function(x){return x.l}),datasets:[{label:'Payout',data:d.map(function(x){return x.p}),backgroundColor:CL.coral,borderRadius:selGran==='weekly'?2:6,barPercentage:selGran==='weekly'?0.9:0.6}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:true,position:'top',labels:{usePointStyle:true,padding:16,font:{size:12}}}},scales:{y:{grid:{color:'#F0F0EC'},ticks:{callback:function(v){return fmt(v)}}},x:{grid:{display:false},ticks:{font:{size:fontSize},maxRotation:selGran==='weekly'?90:0}}}}})}
function r5(){var d=cd(selYear);var rates=d.map(function(x){return x.n>0?x.p/x.n:0});var fontSize=selGran==='weekly'?9:12;nk('r5');ch.r5=new Chart($('c5'),{type:'line',data:{labels:d.map(function(x){return x.l}),datasets:[{label:'Avg/Night',data:rates,borderColor:CL.teal,backgroundColor:'rgba(0,166,153,0.08)',borderWidth:2.5,fill:true,tension:0.3,pointRadius:selGran==='weekly'?1:5,pointBackgroundColor:CL.teal,pointBorderColor:'#fff',pointBorderWidth:selGran==='weekly'?0:2}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{grid:{color:'#F0F0EC'},ticks:{callback:function(v){return '$'+Math.round(v)}}},x:{grid:{display:false},ticks:{font:{size:fontSize},maxRotation:selGran==='weekly'?90:0}}}}})}
function r6(){var d=cd(selYear);var fontSize=selGran==='weekly'?9:12;nk('r6');ch.r6=new Chart($('c6'),{type:'bar',data:{labels:d.map(function(x){return x.l}),datasets:[{label:'Nights',data:d.map(function(x){return x.n}),backgroundColor:selYear==='all'?CC:CL.teal,borderRadius:selGran==='weekly'?2:6,barPercentage:selGran==='weekly'?0.9:0.55}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{grid:{color:'#F0F0EC'}},x:{grid:{display:false},ticks:{font:{size:fontSize},maxRotation:selGran==='weekly'?90:0}}}}})}
function rTable(){if(selYear==='all'){$('yearTable').innerHTML=YD.map(function(y){return '<tr><td class="td-bold">'+y.year+'</td><td>'+fmtF(y.payment)+'</td><td class="td-coral">'+fmtF(y.payout)+'</td><td class="td-purple">'+fmtF(y.commission)+'</td><td>'+y.bookings+'</td><td>'+y.nights+'</td><td>'+y.guests+'</td><td class="td-teal">$'+y.avgNight.toFixed(0)+'</td><td>'+(y.nights/y.bookings).toFixed(1)+' nights</td></tr>'}).join('')}else{var d=cd(selYear);$('yearTable').innerHTML=d.filter(function(x){return x.p>0}).map(function(x){var an=x.n>0?(x.p/x.n):0;return '<tr><td class="td-bold">'+x.l+'</td><td>\u2014</td><td class="td-coral">'+fmtF(x.p)+'</td><td>\u2014</td><td>'+x.b+'</td><td>'+x.n+'</td><td>'+x.g+'</td><td class="td-teal">$'+Math.round(an)+'</td><td>'+(x.b>0?(x.n/x.b).toFixed(1):'-')+' nights</td></tr>'}).join('')}}
function r7(){nk('r7');var sd2=selYear==='all'?SD.slice(0,10):SBY[selYear]||[];var labels=sd2.map(function(s){return s.s});var data=sd2.map(function(s){return s.p});var bg=data.map(function(v,i){return 'rgba(255,90,95,'+(1-i*0.08)+')'});ch.r7=new Chart($('c7'),{type:'bar',data:{labels:labels,datasets:[{data:data,backgroundColor:bg,borderRadius:6,barPercentage:0.55}]},options:{responsive:true,maintainAspectRatio:false,indexAxis:'y',scales:{x:{grid:{color:'#F0F0EC'},ticks:{callback:function(v){return fmt(v)}}},y:{grid:{display:false}}}}})}
function r8(){nk('r8');var cd2=selYear==='all'?[{c:'Phoenix',b:13},{c:'Tucson',b:9},{c:'New York',b:8},{c:'Seattle',b:8},{c:'San Diego',b:5},{c:'Los Angeles',b:4},{c:'Flagstaff',b:4},{c:'Dallas',b:3},{c:'Las Vegas',b:3}]:CBY[selYear]||[];var labels=cd2.map(function(c){return c.c});var data=cd2.map(function(c){return c.b});var bg=data.map(function(v,i){return 'rgba(0,166,153,'+(1-i*0.08)+')'});ch.r8=new Chart($('c8'),{type:'bar',data:{labels:labels,datasets:[{data:data,backgroundColor:bg,borderRadius:6,barPercentage:0.55}]},options:{responsive:true,maintainAspectRatio:false,indexAxis:'y',scales:{x:{grid:{color:'#F0F0EC'}},y:{grid:{display:false}}}}})}
function r9(){var d=cd(selYear);var fontSize=selGran==='weekly'?9:12;nk('r9');ch.r9=new Chart($('c9'),{type:selGran==='weekly'?'bar':'line',data:{labels:d.map(function(x){return x.l}),datasets:[{data:d.map(function(x){return x.g}),borderColor:CL.purple,backgroundColor:selGran==='weekly'?CL.purple:'rgba(145,70,105,0.08)',borderWidth:selGran==='weekly'?0:2.5,fill:true,tension:0.3,pointRadius:selGran==='weekly'?0:5,pointBackgroundColor:CL.purple,pointBorderColor:'#fff',pointBorderWidth:2,borderRadius:selGran==='weekly'?2:0,barPercentage:0.9}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{grid:{color:'#F0F0EC'}},x:{grid:{display:false},ticks:{font:{size:fontSize},maxRotation:selGran==='weekly'?90:0}}}}})}
function r10(){nk('r10');ch.r10=new Chart($('c10'),{type:'bar',data:{labels:YD.map(function(y){return y.year}),datasets:[{label:'Payout',data:YD.map(function(y){return y.payout}),backgroundColor:'rgba(255,90,95,0.8)',borderRadius:6,barPercentage:0.45,yAxisID:'y'},{label:'Bookings',data:YD.map(function(y){return y.bookings}),type:'line',borderColor:CL.teal,borderWidth:2.5,pointRadius:5,pointBackgroundColor:CL.teal,pointBorderColor:'#fff',pointBorderWidth:2,yAxisID:'y1'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:true,position:'top',labels:{usePointStyle:true,padding:16,font:{size:12}}}},scales:{y:{position:'left',grid:{color:'#F0F0EC'},ticks:{callback:function(v){return fmt(v)}}},y1:{position:'right',grid:{display:false}}}}})}
/* Guest table */
function rGuestTable(){var gd=selYear==='all'?GD:(GBY[selYear]||[]);$('guestTable').innerHTML=gd.map(function(g,i){var an=g.ni>0?(g.p/g.ni):0;return '<tr><td>'+(i+1)+'</td><td class="td-bold">'+g.n+'</td><td class="td-coral">'+fmtF(g.p)+'</td><td>'+g.ni+'</td><td class="td-teal">$'+Math.round(an)+'</td><td>'+g.st+'</td><td>'+g.bk+'</td></tr>'}).join('')}
/* US Map */
function renderMap(){var sd2=selYear==='all'?SD:(SBY[selYear]||[]);var maxP=sd2.length?sd2[0].p:1;var lookup={};sd2.forEach(function(s){lookup[s.s]=s});
var states='AL AK AZ AR CA CO CT DE FL GA HI ID IL IN IA KS KY LA ME MD MA MI MN MS MO MT NE NV NH NJ NM NY NC ND OH OK OR PA RI SC SD TN TX UT VT VA WA WV WI WY DC'.split(' ');
/* Simple US map using positioned divs as a grid representation */
var grid=[
['','','','','','','','','','','ME'],
['WA','MT','ND','MN','WI','','MI','','','VT','NH'],
['OR','ID','SD','IA','IL','IN','OH','PA','NJ','MA','CT'],
['CA','NV','WY','NE','MO','KY','WV','VA','MD','RI',''],
['','UT','CO','KS','AR','TN','NC','DC','DE','',''],
['','AZ','NM','OK','LA','MS','AL','GA','SC','',''],
['','','','TX','','','','FL','','HI',''],
['','','','','','','','','','AK','']
];
var html='<div style="display:grid;grid-template-columns:repeat(11,1fr);gap:3px;max-width:660px;margin:12px auto">';
grid.forEach(function(row){row.forEach(function(st){
if(!st){html+='<div></div>';return}
var d=lookup[st];var pct=d?(d.p/maxP):0;var alpha=d?Math.max(0.08,pct):0.03;
var bg=d?'rgba(255,90,95,'+alpha+')':'var(--border-light)';
var tip=d?st+': '+fmtF(d.p)+' ('+d.b+' bookings)':st+': No bookings';
html+='<div title="'+tip+'" style="background:'+bg+';border-radius:5px;padding:6px 2px;text-align:center;font-size:10px;font-weight:700;color:'+(d&&pct>0.3?'var(--coral)':'var(--text-light)');
html+=';border:1px solid '+(d?'rgba(255,90,95,'+Math.min(alpha+0.15,1)+')':'var(--border)');
html+='">'+st+(d?'<div style="font-size:8px;font-weight:400;margin-top:1px">'+fmt(d.p)+'</div>':'')+'</div>'})});
html+='</div>';$('usMapWrap').innerHTML=html}
function refreshFiltered(){renderKPIs();r1();r2();r3();r4();r5();r6();rTable();r7();r8();r9();rGuestTable();renderMap()}
/* FORECAST */
function getForecast(pct){var scale=pct/100;var totalActual=0;var totalForecast=0;var totalNights=0;var totalBookings=0;var months=[];for(var m=1;m<=12;m++){var isActual=A26.hasOwnProperty(m);if(isActual){var p=A26[m];var n=AN26[m];var b=AB26[m];totalActual+=p;totalNights+=n;totalBookings+=b;months.push({m:m,p:p,n:n,b:b,actual:true})}else{var p=HA[m]*scale;var n=Math.round(HN[m]*scale);var b=Math.round(HB[m]*scale);totalForecast+=p;totalNights+=n;totalBookings+=b;months.push({m:m,p:p,n:n,b:b,actual:false})}}return{months:months,totalActual:totalActual,totalForecast:totalForecast,grandTotal:totalActual+totalForecast,totalNights:totalNights,totalBookings:totalBookings}}
function renderForecast(pct){var fc=getForecast(pct);$('sliderVal').textContent=pct+'%';$('fcSub').textContent='Actual + forecast at '+pct+'% of historical avg';$('forecastKPIs').innerHTML='<div class="fkpi"><div class="fkpi-label">Confirmed Revenue</div><div class="fkpi-value" style="color:var(--teal)">'+fmtF(fc.totalActual)+'</div><div class="fkpi-sub">7 months actual</div></div><div class="fkpi"><div class="fkpi-label">Forecasted Add\'l</div><div class="fkpi-value" style="color:var(--coral)">'+fmtF(fc.totalForecast)+'</div><div class="fkpi-sub">5 months projected</div></div><div class="fkpi"><div class="fkpi-label">Projected Total</div><div class="fkpi-value" style="color:var(--purple)">'+fmtF(fc.grandTotal)+'</div><div class="fkpi-sub">full year 2026</div></div><div class="fkpi"><div class="fkpi-label">Projected Nights</div><div class="fkpi-value">'+fc.totalNights+'</div><div class="fkpi-sub">'+fc.totalBookings+' total bookings</div></div>';
var actuals=[];var forecasts=[];for(var i=0;i<12;i++){var d=fc.months[i];if(d.actual){actuals.push(d.p);forecasts.push(0)}else{actuals.push(0);forecasts.push(d.p)}}
nk('fc1');ch.fc1=new Chart($('c11'),{type:'bar',data:{labels:MO,datasets:[{label:'Actual',data:actuals,backgroundColor:CL.teal,borderRadius:6,barPercentage:0.6},{label:'Forecast',data:forecasts,backgroundColor:'rgba(255,90,95,0.5)',borderRadius:6,barPercentage:0.6,borderWidth:2,borderColor:CL.coral}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:true,position:'top',labels:{usePointStyle:true,padding:16,font:{size:12}}}},scales:{y:{grid:{color:'#F0F0EC'},ticks:{callback:function(v){return fmt(v)}}},x:{grid:{display:false}}}}});
var scenarios=[25,50,75,100,125,150];var scenarioTotals=scenarios.map(function(s){return getForecast(s).grandTotal});var scenarioBg=scenarios.map(function(s){return s===pct?CL.coral:'rgba(255,90,95,0.25)'});
nk('fc2');ch.fc2=new Chart($('c12'),{type:'bar',data:{labels:scenarios.map(function(s){return s+'%'}),datasets:[{data:scenarioTotals,backgroundColor:scenarioBg,borderRadius:6,barPercentage:0.55}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{grid:{color:'#F0F0EC'},ticks:{callback:function(v){return fmt(v)}}},x:{grid:{display:false}}}}});
var priorYears=YD.map(function(y){return y.payout});var priorLabels=YD.map(function(y){return String(y.year)});priorLabels[5]+=' (proj)';priorYears[5]=fc.grandTotal;
nk('fc3');ch.fc3=new Chart($('c13'),{type:'bar',data:{labels:priorLabels,datasets:[{data:priorYears,backgroundColor:YD.map(function(y,i){return i===5?'rgba(255,90,95,0.5)':CL.teal}),borderColor:YD.map(function(y,i){return i===5?CL.coral:'transparent'}),borderWidth:2,borderRadius:6,barPercentage:0.55}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{grid:{color:'#F0F0EC'},ticks:{callback:function(v){return fmt(v)}}},x:{grid:{display:false}}}}});
$('forecastTable').innerHTML=fc.months.map(function(d){var tag=d.actual?'<span class="tag-actual">ACTUAL</span>':'<span class="tag-forecast">FORECAST</span>';return '<tr><td class="td-bold">'+MO[d.m-1]+'</td><td>'+tag+'</td><td'+(d.actual?' class="td-teal"':' class="td-coral"')+'>'+fmtF(d.p)+'</td><td>'+d.n+'</td><td>'+d.b+'</td></tr>'}).join('')}
/* RATE OPTIMIZER */
var DEMAND_A=325.3;var DEMAND_B=-0.626;var HIST_RATES=[248,376,201,193,311];var HIST_NIGHTS=[219,89,149,225,113];var CUR_RATE=368;var CUR_NIGHTS=68;var OPT_RATE=260;
function estNights(rate){return Math.max(DEMAND_A+DEMAND_B*rate,0)}
function estRevenue(rate){return rate*estNights(rate)}
function renderRateOptimizer(rate){$('rateVal').textContent='$'+rate;var en=Math.round(estNights(rate));var er=estRevenue(rate);var occ=(en/365*100);var curRev=estRevenue(CUR_RATE);var optRev=estRevenue(OPT_RATE);var vsCurrent=er-curRev;var vsOpt=er-optRev;
$('rateKPIs').innerHTML='<div class="fkpi"><div class="fkpi-label">Est. Annual Nights</div><div class="fkpi-value" style="color:var(--teal)">'+en+'</div><div class="fkpi-sub">'+occ.toFixed(1)+'% occupancy</div></div><div class="fkpi"><div class="fkpi-label">Est. Annual Revenue</div><div class="fkpi-value" style="color:'+(er>=curRev?'var(--teal)':'var(--coral)')+'">'+fmtF(er)+'</div><div class="fkpi-sub">at $'+rate+'/night</div></div><div class="fkpi"><div class="fkpi-label">vs Current ($'+CUR_RATE+')</div><div class="fkpi-value" style="color:'+(vsCurrent>=0?'var(--teal)':'var(--coral)')+'">'+(vsCurrent>=0?'+':'')+fmtF(vsCurrent)+'</div><div class="fkpi-sub">'+(vsCurrent>=0?'additional':'less')+' revenue</div></div><div class="fkpi"><div class="fkpi-label">vs Optimal ($'+OPT_RATE+')</div><div class="fkpi-value" style="color:'+(vsOpt>=0?'var(--teal)':'var(--coral)')+'">'+(vsOpt>=0?'+':'')+fmtF(vsOpt)+'</div><div class="fkpi-sub">'+(Math.abs(vsOpt)<500?'at peak!':'from maximum')+'</div></div>';
$('curveSub').textContent='Sweet spot at $'+OPT_RATE+'/night';
var curveRates=[];var curveRevs=[];var curveBg=[];for(var r=100;r<=450;r+=10){curveRates.push('$'+r);curveRevs.push(estRevenue(r));curveBg.push(r===rate?CL.coral:r===OPT_RATE?CL.gold:r===CUR_RATE?CL.purple:'rgba(0,166,153,0.3)')}
nk('rc1');ch.rc1=new Chart($('c14'),{type:'bar',data:{labels:curveRates,datasets:[{data:curveRevs,backgroundColor:curveBg,borderRadius:4,barPercentage:0.9}]},options:{responsive:true,maintainAspectRatio:false,scales:{y:{grid:{color:'#F0F0EC'},ticks:{callback:function(v){return fmt(v)}}},x:{grid:{display:false},ticks:{maxTicksLimit:12,font:{size:10}}}}}});
var scatterData=[];for(var i=0;i<5;i++){scatterData.push({x:HIST_RATES[i],y:HIST_NIGHTS[i]})}var lineX=[];var lineY=[];for(var r=100;r<=450;r+=10){lineX.push(r);lineY.push(estNights(r))}
nk('rc2');ch.rc2=new Chart($('c15'),{type:'scatter',data:{datasets:[{label:'Historical',data:scatterData,backgroundColor:CL.teal,pointRadius:8},{label:'Demand Curve',data:lineX.map(function(x,i){return{x:x,y:lineY[i]}}),type:'line',borderColor:'rgba(255,90,95,0.4)',borderWidth:2,borderDash:[6,4],pointRadius:0,fill:false},{label:'Selected',data:[{x:rate,y:estNights(rate)}],backgroundColor:CL.coral,pointRadius:12,pointStyle:'star'},{label:'2026 Actual',data:[{x:CUR_RATE,y:CUR_NIGHTS*365/243}],backgroundColor:CL.purple,pointRadius:8,pointStyle:'triangle'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:true,position:'top',labels:{usePointStyle:true,padding:12,font:{size:11}}}},scales:{x:{title:{display:true,text:'Rate ($)'},grid:{color:'#F0F0EC'},min:100,max:450},y:{title:{display:true,text:'Annual Nights'},grid:{color:'#F0F0EC'}}}}});
var beRates=[150,175,200,225,250,275,300,325,350,375,400];var beDeltas=beRates.map(function(r){return estRevenue(r)-estRevenue(CUR_RATE)});var beBg=beRates.map(function(r){return estRevenue(r)>=estRevenue(CUR_RATE)?'rgba(0,166,153,0.6)':'rgba(255,90,95,0.5)'});
nk('rc3');ch.rc3=new Chart($('c16'),{type:'bar',data:{labels:beRates.map(function(r){return '$'+r}),datasets:[{label:'vs Current ($'+CUR_RATE+')',data:beDeltas,backgroundColor:beBg,borderRadius:6,barPercentage:0.6}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:true,position:'top',labels:{usePointStyle:true,padding:12,font:{size:11}}}},scales:{y:{grid:{color:'#F0F0EC'},ticks:{callback:function(v){return(v>=0?'+':'')+fmt(v)}}},x:{grid:{display:false}}}}});
var tableRates=[150,175,200,225,250,260,275,300,CUR_RATE,400];$('rateTable').innerHTML=tableRates.map(function(r){var en2=Math.round(estNights(r));var er2=estRevenue(r);var occ2=(en2/365*100).toFixed(1);var diff=er2-estRevenue(CUR_RATE);var diffStr=(diff>=0?'+':'')+fmtF(diff);var note='';if(r===OPT_RATE)note='<span style="color:var(--gold);font-weight:700">\u2605 SWEET SPOT</span>';else if(r===CUR_RATE)note='<span style="color:var(--purple);font-weight:700">CURRENT</span>';return '<tr style="'+(r===rate?'background:rgba(255,90,95,0.04)':'')+'"><td class="td-bold">$'+r+'/night</td><td>'+en2+'</td><td>'+occ2+'%</td><td class="'+(er2>=estRevenue(CUR_RATE)?'td-teal':'td-coral')+'">'+fmtF(er2)+'</td><td style="color:'+(diff>=0?'var(--teal)':'var(--coral)')+'">'+diffStr+'</td><td>'+note+'</td></tr>'}).join('')}
/* INIT */
renderKPIs();r1();r2();r3();r4();r5();r6();rTable();r7();r8();r9();r10();rGuestTable();renderMap();renderForecast(100);renderRateOptimizer(260);
$('tab-revenue').classList.add('hidden');$('tab-guests').classList.add('hidden');$('tab-insights').classList.add('hidden');$('tab-forecast').classList.add('hidden');
$('tabs').addEventListener('click',function(e){if(!e.target.classList.contains('tab-btn'))return;document.querySelectorAll('.tab-btn').forEach(function(b){b.classList.remove('active')});e.target.classList.add('active');var tab=e.target.getAttribute('data-tab');document.querySelectorAll('.tp').forEach(function(p){p.classList.add('hidden')});$('tab-'+tab).classList.remove('hidden')});
$('yearFilter').addEventListener('click',function(e){if(!e.target.classList.contains('year-btn'))return;document.querySelectorAll('.year-btn').forEach(function(b){b.classList.remove('active')});e.target.classList.add('active');selYear=e.target.getAttribute('data-year');updateGranVisibility();refreshFiltered()});
$('granFilter').addEventListener('click',function(e){if(!e.target.classList.contains('gran-btn'))return;document.querySelectorAll('.gran-btn').forEach(function(b){b.classList.remove('active')});e.target.classList.add('active');selGran=e.target.getAttribute('data-gran');refreshFiltered()});
$('occSlider').addEventListener('input',function(){renderForecast(parseInt(this.value))});
$('rateSlider').addEventListener('input',function(){renderRateOptimizer(parseInt(this.value))});
</script>
</body>
</html>